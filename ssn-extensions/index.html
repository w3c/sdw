<!DOCTYPE html>
<html lang="en">
<head>
  <meta content="text/html; charset=utf-8" http-equiv="content-type">
  <title>Extensions to the Semantic Sensor Network Ontology</title>
  <script class="remove" src="https://www.w3.org/Tools/respec/respec-w3c-common"></script>
  <script class="remove" src="config.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" type="text/css" href="small.css" media="only all and (max-width: 649px)">
</head>

<body>

<section id="abstract">
<p>The Semantic Sensor Network (SSN) ontology is an ontology for describing sensors and their observations, the procedures used, the features of interest and observed properties that are the subject of observation, samples used in the course of observations, as well as actuators.
This document describes some extensions to the SSN ontology to enable:</p>
<ol>
  <li>
    linking directly to the ultimate feature-of-interest for an act of observation, sampling, or actuation, alongside the link to the (proximate) feature-of-interest, which might be a sample
  </li>
  <li>
    homogeneous collections of observations, in which one or more of the feature-of-interest, ultimate feature-of-interest, observed-property, procedure, sensor, phenomenon-time or result-time may be shared by all members of the collection
  </li>
</ol>
<p style="text-align: center;">The namespace for SSN terms is <span class="repeated"
    style="font-family: courier;">http://www.w3.org/ns/ssn/</span>
    <br>
    The namespace for SOSA terms is <span class="repeated" style="font-family: courier;">
      http://www.w3.org/ns/sosa/</span>
</p>
<p style="text-align: center;">The suggested prefix for the SSN namespace
  is <span class="repeated" style="font-family: courier;">ssn</span>
  <br>
  The suggested prefix for the SOSA namespace is <span class="repeated" style="font-family: courier;">sosa</span>
</p>
<p style="text-align: center;"> The SSN ontology is available at <a href="http://www.w3.org/ns/ssn/">http://www.w3.org/ns/ssn/</a>.
  <br>
  The SOSA ontology is available at <a href="http://www.w3.org/ns/sosa/">http://www.w3.org/ns/sosa/</a>.
  <br>
  The SSN-Extensions ontology is available at <a href="https://github.com/w3c/sdw/tree/gh-pages/ssn-extensions/rdf">https://github.com/w3c/sdw/tree/gh-pages/ssn-extensions/rdf</a>.
</p>

</section>

<section id="sotd">
<p><strong>For OGC -</strong> This is a Public Draft of a document prepared by the Spatial Data on the Web Interest Group
	(<a href="https://www.w3.org/2017/sdwig/">SDWIG</a>)
— a joint W3C-OGC project (see <a href="https://www.w3.org/2017/sdwig/charter.html">charter</a>).
The document is prepared following W3C conventions. This document is not an OGC Standard. This document is distributed for review and comment. This document is subject to change without notice and may not be referred to as an OGC Standard. Recipients of this document are invited to submit, with their comments, notification of any relevant patent rights of which they are aware and to provide supporting documentation. </p>
<p>New classes and properties are introduced in this extension to SSN.
  The new elements primarily relate to additional requirements for describing observations and collections of observations.
  The ontology document &lt;owl:imports&gt; the SSN ontology, and adds the new elements and axioms in a new RDF namespace. </p>
</section>

<section id="motivation" class="informative">
<h2>Motivation and background</h2>
<p>The Semantic Sensor Network (SSN) ontology is an ontology for describing sensors and their observations, the involved procedures, the studied features of interest, the samples used to do so, and the observed properties, as well as actuators [[vocab-ssn]].
The elements of the ontology are defined in two modules:</p>
<ul>
  <li>
    SOSA - which defines the basic classes and properties, with a weak axiomatization comparable to schema.org
  </li>
  <li>
    SSN - which adds a full axiomatization to the SOSA classes and properties, and adds additional elements relating particularly to sensor descriptions and to support alignment to <a href="http://ontologydesignpatterns.org/wiki/Ontology:DOLCE+DnS_Ultralite">DOLCE Ultralite</a>
  </li>
</ul>
<p>
  However, a number of requirements for describing observations that have been described in the research literature ([[?OM-Lite]], [[?OBOE]]) are not supported directly by SSN.
  In particular:
</p>
<ol>
  <li>
    discovery and use of observation data typically depends on their relationship to an <i>ultimate</i> feature-of-interest, which is a known thing in the world (such as a geological formation, or a specific patient, or the state of the atmosphere). However, if the (proximate) feature-of-interest of the observation is a <i>sample</i> of the ultimate feature-of-interest (such as a rock specimen, a blood or biopsy sample, or a specific transect through the atmosphere), the identity of the ultimate feature-of-interest can be obtained only by following a chain of one or more <a href="https://www.w3.org/TR/vocab-ssn/#SOSAisSampleOf">sosa:isSampleOf</a> relationships, if they are even recorded. This may not be possible in a single request on a data service
  </li>
  <li>
    discovery and management of samples and sample data depends on the relationship of a sample to the actual feature of interest for which it is a proxy. The <a href="https://www.w3.org/TR/vocab-ssn/#SOSAisSampleOf">sosa:isSampleOf</a> relationship is key, but in many cases there is a chain of samples, each sub-sampling another sample, so the link to the original feature-of-interest is indirect. Furthermore, in some cases (for example chemical analyses) multiple sub-samples are made and used to measure different characteristics, and it is helpful if these can all be related to the original <i>sample</i> that was taken immediately from the feature of interest. 
  </li>
  <li>
    observations are usually made as part of a set or collection, within which variations of the result are of interest. A collection is typically designed so that one or more of the key observation properties are shared by all members of the collection -
    <a href="https://www.w3.org/TR/vocab-ssn/#SOSAhasFeatureOfInterest">hasFeatureOfInterest</a>,
    <a href="https://www.w3.org/TR/vocab-ssn/#SOSAobservedProperty">observedProperty</a>,
    <a href="https://www.w3.org/TR/vocab-ssn/#SOSAobservedProperty">madeBySensor</a>,
    <a href="https://www.w3.org/TR/vocab-ssn/#SOSAusedProcedure">usedProcedure</a>,
    <a href="https://www.w3.org/TR/vocab-ssn/#SOSAphenomenonTime">phenomenonTime</a>,
    <a href="https://www.w3.org/TR/vocab-ssn/#SOSAresultTime">resultTime</a>
    For efficient discovery and data transfer it is helpful if the <i>set</i> of observation descriptions is packaged in a standard way that captures the common properties at the collection level.
  </li>
</ol>

<p>
  This document describes solutions these requirements.
</p>
</section>

<section id="namespaces" class="normative">
<h2>Notation and namespaces</h2>
  <p>The classes and properties described in this document are denoted using <a href="https://www.w3.org/TR/curie/">Compact URIs</a> [[curie]]. 
  These classes and properties are put into the RDF namespace for SOSA, i.e. <code>http://www.w3.org/ns/sosa/</code> which is used for the core elements of SSN [[vocab-ssn]], since the new classes and properties are expected to be used in the same context. 
  However, these extensions to SOSA/SSN are packaged in a separate graph (ontology file) which is denoted <code>http://www.w3.org/ns/ssn/ext/</code>, and is currently available from the <a href="https://raw.githubusercontent.com/w3c/sdw/gh-pages/ssn-extensions/rdf/ssn-ext.ttl">GitHub repository</a>. 
</p>
<!--
<p>The namespace for the SSN-Extensions graph is <code>http://www.w3.org/ns/ssn/ext/</code>.
  SSN-Extension re-uses elements from SSN and SOSA [[vocab-ssn]]. </p>
-->
<p></p>
<p>The table below indicates the full list of namespaces and prefixes used in this document.</p>
<table id="namespacesTable">
<thead>
<tr>
<th>Prefix</th>
<th>Namespace</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>owl</code></td>
<td><code>http://www.w3.org/2002/07/owl#</code></td>
</tr>
<tr>
<td><code>rdf</code></td>
<td><code>http://www.w3.org/1999/02/22-rdf-syntax-ns#</code></td>
</tr>
<tr>
<td><code>rdfs</code></td>
<td><code>http://www.w3.org/2000/01/rdf-schema#</code></td>
</tr>
<tr>
<td><code>sosa</code></td>
<td><code>http://www.w3.org/ns/sosa/</code></td>
</tr>
<tr>
<td><code>ssn</code></td>
<td><code>http://www.w3.org/ns/ssn/</code></td>
</tr>
<!--
<tr>
  <td><code>test</code></td>
  <td><code>http://example.org/ssn-ext-test/</code></td>
</tr>
-->
<tr>
<td><code>xsd</code></td>
<td><code>http://www.w3.org/2001/XMLSchema#</code></td>
</tr>
</tbody>
</table>

<p>Where class descriptions include local restrictions on properties, these are described using the OWL 2 Manchester Syntax [[owl2-manchester-syntax]]. </p>

<p>Examples and other code fragments are serialized using RDF 1.1 Turtle notation [[turtle]].
  All examples and tests are available from the <a href="https://github.com/w3c/sdw/tree/gh-pages/ssn-extensions/rdf">GitHub repository</a>.
</p>

</section>

<section id="overview" class="informative">
<h2>Principles and vocabulary overview</h2>

<section id="ultimate-feature-of-interest">
<h3>Ultimate feature of interest</h3>
<p>The object of the original <a href="https://www.w3.org/TR/vocab-ssn/#SOSAhasFeatureOfInterest">hasFeatureOfInterest</a> property of an act of observation, sampling, or actuation is the <i>immediate</i> or <i>proximate</i> <a href="https://www.w3.org/TR/vocab-ssn/#SOSAFeatureOfInterest">FeatureOfInterest</a>.
In some cases this is not the the ultimate thing that the act of observation, sampling, or actuation is concerned with, but is an intermediate thing, often a <i>sample</i> of the ultimate feature of interest, or perhaps a sample of a sample, etc.
There will often be a specifiable relationship between the proximate and ultimate feature of interest, such as a sampling-chain. 
If this relationship is recorded, then an ultimate feature of interest might be inferred.
Nevertheless, particularly for discovery purposes, it is usually the ultimate feature of interest that really matters to the data user.
This requirement is satisfied by an <a href="https://www.w3.org/TR/owl2-primer/#Object_Properties">object property</a> called <code>hasUltimateFeatureOfInterest</code>. 
</p>
<p>Some patterns for the relationship of the ultimate feature of interest to observations  (<a href="#fig-observation-ultimate-foi"></a>) and acts of sampling (<a href="#fig-sampling-ultimate-foi"></a>), and within sampling-chains, are illustrated below.</p>

<figure id="fig-observation-ultimate-foi">
  <img alt="Observation feature-of-interest patterns 1" src="./images/observation-foi-patterns.png" style="width:75%"/>
  <figcaption>Patterns for observations that relate to the ultimate feature of interest directly (top),
    or indirectly via one sample (middle) or a chain of samples (bottom) - new property shown in red</figcaption>
</figure>

<figure id="fig-sampling-ultimate-foi">
  <img alt="Sampling feature-of-interest patterns 2" src="./images/sampling-foi-patterns.png" style="width:75%"/>
  <figcaption>Patterns for sampling that relate to the ultimate feature of interest directly (top),
    or indirectly via one intermediate sample (middle) or a chain of intermediate samples (bottom) - new properties shown in red</figcaption>
</figure>

<p class="note">
  This requirement was described in OM-Lite [[?OM-Lite]], but was addressed there using a different pattern in which the property <code>oml:featureOfInterest</code> always links to the <i>ultimate</i> feature-of-interest, and an additional property <code>oml:samplingStrategy</code> links to the sample or some other description of the sampling arrangements.
  However, that approach allowed multiple possible interpretations of ‘featureOfInterest’, and only representated chains of sampling or observation events indirectly.
  The solution described here is explicit, and also applies to acts of sampling and actuation.
</p>

</section>

<section id="sample-chains">
  <h3>Basis of a chain of samples</h3>
  <p>
    Many observation workflows rely on a chain of samples, each making a sub-sample of the predecessor sample. 
    Knowing either the original sample or the initial feature of interest at the base of the chain is often useful for both discovery and management purposes. 
    For example, <a href="#fig-sample-chain-geology"></a> shows a scenario from geology involving many samples derived from an initial one, with some relationships that may be useful in processing and discovery of subsequent observations, the intention of which will be to characterize various aspects of the original sample which is representative of an ultimate feature of interest. 
    This is supported by two further <a href="https://www.w3.org/TR/owl2-primer/#Object_Properties">object properties</a> for relationships between samples and features of interest, called <code>hasOriginalSample</code> and <code>hasSampledFeature</code>.
  </p>

  <figure id="fig-sample-chain-geology">
    <img alt="Sample chain example from geology" src="./images/SamplingChainGeology.png" style="width:90%"/>
    <figcaption>It is common to generate a chain of samples in a geology exploration scenario, with initial sample retrieval from the field followed by a sequence of sample preparation steps to generate a series of sub-samples. 
    </figcaption>
  </figure>

  <p>Having a direct indication of an original sample allows multiple results to be combined to describe the sample. 
    Having a direct indication of the ultimate feature being sampled allows discovery of many samples that are intended to be representative of that feature. 
  </p>
    
    <p class="Note">Note that the scenario in <a href="#fig-sample-chain-geology"></a> is simplified from real-life scenarios, and also that the diagram only shows a subset of the full set of resources and relationships.</p>

</section>

<section id="observation-collection">
<h3>Homogeneous collection of observations</h3>

<p>
  A collection of observations may share a common value for one or more of the characteristic observation properties.
  For example:
</p>
<ul>
  <li>
    many monitoring processes generate a stream of data in which only the (phenomenon-) time changes between consecutive results for the same property on a single feature of interest, observed using the same procedure implemented using the same sensor. 
  </li>
  <li>
    a sensor network typically generates a set of results, over the same time interval, for the same property(s), over a suite of features-of-interest. 
    Imaging sensors could be considered a special case of this, where the proximate features-of-interest correspond with individual pixels in the result. 
  </li>
</ul>
</p>
<p>
  These patterns can be accommodated with the class <code>ObservationCollection</code> individuals of which may hold one or more of the essential properties of an atomic observation, except for the result. 
  Where present, the value of the property(s) of the collection are shared by all member observations.
  Of the essential properties of an observation, only the value of each actual <a href="https://www.w3.org/TR/vocab-ssn/#SOSAhasResult">hasResult</a> is not potentially shared by all member observations, though at least one of the other properties would be expected to vary between members in a typical collection.
</p>

<p>For example, <a href="#fig-observation-collection-3"></a> describes a collection of remote sensing observations using the same sensor on different scenes, while <a href="#fig-observation-collection-4"></a> is a series of the same scene on different days. </p>

<figure id="fig-observation-collection-3">
  <img alt="Collections of observations 3" src="./images/OC-instance-3.png" style="width:90%"/>
  <figcaption>A set of remote sensing observations of different scenes on the same day</figcaption>
</figure>

<figure id="fig-observation-collection-4">
  <img alt="Collections of observations 4" src="./images/OC-instance-4.png" style="width:90%"/>
  <figcaption>A series of remote sensing observations of the same scene on the different days</figcaption>
</figure>

<p>
  Collections may be nested. 
  For example, an outer observation-collection might share the observed-property, procedure and sensor, and contain inner observation-collections at different phenomenon-times, each of which contain a set of observations on different features-of-interest (<a href="#fig-observation-collection-1"></a>).
</p>

<figure id="fig-observation-collection-1">
  <img alt="Nested collections of observations 1" src="./images/OC-instance-1.png" style="width:90%"/>
  <figcaption>Example of a set of nested collections of four observations of the same property of two features-of-interest at two different times.</figcaption>
</figure>

<p>
  Observations can be factored into collections in more than one way, so more than one set of nested observation-collections can collect the same set of atomic results.
  For example, the same outer collection may contain inner collections concerning different features-of-interests, each containing a set of observations at different phenomenon-times (<a href="#fig-observation-collection-2"></a>).
</p>

<figure id="fig-observation-collection-2">
  <img alt="Nested collections of observations 2" src="./images/OC-instance-2.png" style="width:90%"/>
  <figcaption>Alternative set of nested collections with the same results of the same property of two features-of-interest at two different times.</figcaption>
</figure>

<p>
  Effectively, the results of each observation-collection correspond to a <i>slice</i> in a data-cube which is composed of the results of the complete set of observations.
</p>

<p class="note">
  This requirement was addressed in OM-Lite [[?OM-Lite]] following the pattern described here.
</p>

<p class="note">
  This feature might also apply to collections of <i>Actuations</i> but this application has not yet been explored.
</p>

</section>

</section>

<section id="vocabulary" class="normative">
<h2>Vocabulary specification</h2>

<p>In this vocabulary specification, Manchester syntax [[owl2-manchester-syntax]] is used where the value of a field is not a simple term denoted by a URI or cURI [[curie]].</p>

<section id="classes">
<h3>Classes</h3>

<p>
<code><a href="#sosa:ObservationCollection">:ObservationCollection</a></code>
</p>

<section>
<h4 id="sosa:ObservationCollection">Collection of observations</h4>

<p>
  An ObservationCollection has at least one member, and may have one of any of the other seven properties mentioned in restrictions (<a href="#fig-observation-collection-0"></a>).
</p>
<table class="definition" style="width: 100%;">
<thead>
<tr>
<th style="width: 120px;">Class:</th>
<th><code><a href="#sosa:ObservationCollection">sosa:ObservationCollection</a></code></th>
</tr>
</thead>
<tbody>
<tr>
  <td>
    IRI:
  </td>
  <td>
    <code><a href="https://raw.githubusercontent.com/w3c/sdw/gh-pages/ssn-extensions/rdf/ssn-ext.ttl">http://www.w3.org/ns/sosa/ObservationCollection</a></code>
  </td>
</tr>
<tr>
<td>Definition:</td>
<td>Collection of one or more observations, which may be nested in further collections, whose members share a common value for one or more property</td>
</tr>
<tr>
<td>Restrictions:</td>
<td>
  <code><a href="#sosa:hasMember">sosa:hasMember</a> min 1</code>
<br /><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAhasFeatureOfInterest">sosa:hasFeatureOfInterest</a> max 1</code>
<br /><code><a href="#sosa:hasUltimateFeatureOfInterest">sosa:hasUltimateFeatureOfInterest</a> max 1</code>
<br /><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAmadeBySensor">sosa:madeBySensor</a> max 1</code>
<br /><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAobservedProperty">sosa:observedProperty</a> max 1</code>
<br /><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAphenomenonTime">sosa:phenomenonTime</a> max 1</code>
<br /><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAresultTime">sosa:resultTime</a> max 1</code>
<br /><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAusedProcedure">sosa:usedProcedure</a> max 1</code>
</td>
</tr>
</tbody>
</table>

<figure id="fig-observation-collection-0">
  <img alt="Collection of observations sharing one or more key properties" src="./images/observation-collection.png" style="width:60%"/>
  <figcaption>Model for an observation-collection, in which the collection may carry one or more of the properties of its members if they have a shared value for all members - new properties and classes shown in red</figcaption>
</figure>
<p>
  If present, the value of any of <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAhasFeatureOfInterest">sosa:hasFeatureOfInterest</a></code>,
<code><a href="#sosa:hasUltimateFeatureOfInterest">sosa:hasUltimateFeatureOfInterest</a></code>,
<code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAmadeBySensor">sosa:madeBySensor</a></code>,
<code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAobservedProperty">sosa:observedProperty</a></code>,
<code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAphenomenonTime">sosa:phenomenonTime</a></code>,
<code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAresultTime">sosa:resultTime</a></code>, or
<code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAusedProcedure">sosa:usedProcedure</a></code>
applies to all member observations.
See <a href="#container-property-rule">Inheriting observation properties from a collection</a> for a formal definition of the rule.
</p>


</section>

</section>

<section id="properties">
<h3>Properties</h3>

<p>
  <code><a href="#sosa:hasMember">:hasMember</a></code> |
  <code><a href="#sosa:hasOriginalSample">:hasOriginalSample</a></code> |
  <code><a href="#sosa:hasUltimateFeatureOfInterest">:hasUltimateFeatureOfInterest</a></code> | 
  <code><a href="#sosa:hasSampledFeature">:hasSampledFeature</a></code>
</p>

<section>
<h4 id="sosa:hasMember">member observation or collection</h4>
<table class="definition" style="width: 100%;">
<thead>
<tr>
<th style="width: 120px;">Property:</th>
<th><code><a href="#sosa:hasMember">sosa:hasMember</a></code></th>
</tr>
</thead>
<tbody>
  <tr>
    <td>
      IRI:
    </td>
    <td>
      <code><a href="https://raw.githubusercontent.com/w3c/sdw/gh-pages/ssn-extensions/rdf/ssn-ext.ttl">http://www.w3.org/ns/sosa/hasMember</a></code>
    </td>
  </tr>
<tr>
<td>Definition:</td>
<td>Links an Observation or ObservationCollection that shares the same value for one or more of the characteristic properties to an ObservationCollection.</td>
</tr>
<tr>
<td>Instance of:</td>
<td><code>owl:ObjectProperty</code></td>
</tr>
<tr>
<td>Sub-property of:</td>
<td><code><a href="https://www.w3.org/TR/rdf-schema/#ch_member">rdfs:member</a></code></td>
</tr>
<tr>
<td>Domain:</td>
<td><code><a href="#sosa:ObservationCollection">sosa:ObservationCollection</a></code></td>
</tr>
<tr>
<td>Range:</td>
<td><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAObservation">sosa:Observation</a> or <a href="#sosa:ObservationCollection">sosa:ObservationCollection</a></code></td>
</tr>
</tbody>
</table>

<p>
  The global domain and range constraints mean that any appearance of <code><a href="#sosa:hasMember">sosa:hasMember</a></code>
  in a dataset entails that the subject of the statement is a <code><a href="#sosa:ObservationCollection">sosa:ObservationCollection</a></code>
  and the object of the statement is a <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAObservation">sosa:Observation</a></code> or <code><a href="#sosa:ObservationCollection">sosa:ObservationCollection</a></code>.
</p>
</section>

<section>
<h4 id="sosa:hasOriginalSample">has original sample</h4>
<table class="definition" style="width: 100%;">
<thead>
<tr>
<th style="width: 120px;">Property:</th>
<th><code><a href="#sosa:hasOriginalSample">sosa:hasOriginalSample</a></code></th>
</tr>
</thead>
<tbody>
  <tr>
    <td>
      IRI:
    </td>
    <td>
      <code><a href="https://raw.githubusercontent.com/w3c/sdw/gh-pages/ssn-extensions/rdf/ssn-ext.ttl">http://www.w3.org/ns/sosa/hasOriginalSample</a></code>
    </td>
  </tr>
<tr>
<td>Definition:</td>
<td>link to the original sample that is related to the context sample through a chain of isSampleOf relations</td>
</tr>
<tr>
<td>Instance of:</td>
<td><code>owl:ObjectProperty</code></td>
</tr>
<tr>
  <td>Domain:</td>
  <td><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSASample">sosa:Sample</a></code></td>
  </tr>
<tr>
<td>Range:</td>
<td><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSASample">sosa:Sample</a></code></td>
</tr>
</tbody>
</table>

<p>
  The following guarded constraint applies to the <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSASample">sosa:Sample</a></code> class:
</p>

<table class="definition" style="width: 100%;">
<thead>
<tr>
<th style="width: 120px;">Class:</th>
<th><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSASample">sosa:Sample</a></code></th>
</tr>
</thead>
<tbody>
  <tr>
    <td>
      Restrictions:
    </td>
    <td>
      <code><a href="https://raw.githubusercontent.com/w3c/sdw/gh-pages/ssn-extensions/rdf/ssn-ext.ttl">sosa:hasOriginalSample</a> max 1</code>
    </td>
  </tr>
</tbody>
</table>

<p>
  This constraint says that no more than one original-sample is expected for each individual sample.
</p>

</section>

<section>
  <h4 id="sosa:hasUltimateFeatureOfInterest">has ultimate feature of interest</h4>
  <table class="definition" style="width: 100%;">
  <thead>
  <tr>
  <th style="width: 120px;">Property:</th>
  <th><code><a href="#sosa:hasUltimateFeatureOfInterest">sosa:hasUltimateFeatureOfInterest</a></code></th>
  </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        IRI:
      </td>
      <td>
        <code><a href="https://raw.githubusercontent.com/w3c/sdw/gh-pages/ssn-extensions/rdf/ssn-ext.ttl">http://www.w3.org/ns/sosa/hasUltimateFeatureOfInterest</a></code>
      </td>
    </tr>
  <tr>
  <td>Definition:</td>
  <td>link to the ultimate feature of interest of an observation or act of sampling. This is useful when the proximate feature of interest is a sample of the ultimate feature of interest, directly or transitively.</td>
  </tr>
  <tr>
  <td>Instance of:</td>
  <td><code>owl:ObjectProperty</code></td>
  </tr>
  <tr>
    <td>Domain:</td>
    <td><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAObservation">sosa:Observation</a> or <a href="https://www.w3.org/TR/vocab-ssn/#SOSASampling">sosa:Sampling</a> or <a href="https://www.w3.org/TR/vocab-ssn/#SOSAActuation">sosa:Actuation</a></code> </td>
    </tr>
    <tr>
  <td>Range:</td>
  <td><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAFeatureOfInterest">sosa:FeatureOfInterest</a></code></td>
  </tr>
  </tbody>
  </table>
  
  <p>
    The following guarded constraint applies to the <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAObservation">sosa:Observation</a></code> class:
  </p>
  
  <table class="definition" style="width: 100%;">
  <thead>
  <tr>
  <th style="width: 120px;">Class:</th>
  <th><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAObservation">sosa:Observation</a></code></th>
  </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        Restrictions:
      </td>
      <td>
        <code><a href="https://raw.githubusercontent.com/w3c/sdw/gh-pages/ssn-extensions/rdf/ssn-ext.ttl">sosa:hasUltimateFeatureOfInterest</a> min 1</code>
      </td>
    </tr>
  </tbody>
  </table>
  
  <p>
    This constraint says that at least one ultimate-feature-of-interest is expected for each individual observation.
    Typically an observation concerns one ultimate feature-of-interest but in some cases the proximate feature-of-interest is a sample of more than one ultimate feature of interest.
    The explanation of relationships between multiple ultimate features of interest are beyond the scope of this vocabulary.
  </p>
  
  </section>

  <section>
    <h4 id="sosa:hasSampledFeature">has sampled feature</h4>
    <table class="definition" style="width: 100%;">
    <thead>
    <tr>
    <th style="width: 120px;">Property:</th>
    <th><code><a href="#sosa:hasSampledFeature">sosa:hasSampledFeature</a></code></th>
    </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          IRI:
        </td>
        <td>
          <code><a href="https://raw.githubusercontent.com/w3c/sdw/gh-pages/ssn-extensions/rdf/ssn-ext.ttl">http://www.w3.org/ns/sosa/hasSampledFeature</a></code>
        </td>
      </tr>
    <tr>
    <td>Definition:</td>
    <td>link to the ultimate feature of interest of the context sample - i.e. the end of a chain of isSampleOf relations</td>
    </tr>
    <tr>
    <td>Instance of:</td>
    <td><code>owl:ObjectProperty</code></td>
    </tr>
    <tr>
      <td>Domain:</td>
      <td><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSASample">sosa:Sample</a></code></td>
      </tr>
      <tr>
    <td>Range:</td>
    <td><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAFeatureOfInterest">sosa:FeatureOfInterest</a></code></td>
    </tr>
    </tbody>
    </table>
    
    <p>
      The following guarded constraint applies to the <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSASample">sosa:Sample</a></code> class:
    </p>
    
    <table class="definition" style="width: 100%;">
    <thead>
    <tr>
    <th style="width: 120px;">Class:</th>
    <th><code><a href="https://www.w3.org/TR/vocab-ssn/#SOSASample">sosa:Sample</a></code></th>
    </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          Restrictions:
        </td>
        <td>
          <code><a href="https://raw.githubusercontent.com/w3c/sdw/gh-pages/ssn-extensions/rdf/ssn-ext.ttl">sosa:hasSampledFeature</a> min 1</code>
        </td>
      </tr>
    </tbody>
    </table>
    
    <p>
      This constraint says that at least one sampled feature is expected for each individual sample. 
      More than one sampled feature may apply when a single sample proxies for different ultimate features when used in multiple investigations. 
    </p>
    
    </section>
    
  
</section>

<section>
  <h3 id="rules">Rules</h3>

  <section>
    <h4 id="ufoi-sampling-chain-rule">Finding ultimate feature of interest of an Observation or Sampling from a sampling chain</h4>
    <p>
      If the ultimate feature-of-interest of an Observation, Sampling or Actuation, or ObservationCollection is not specified,
      and the feature-of-interest is a Sample,
      then the ultimate-feature-of-interest can be found by following a path from the feature-of-interest
      to the end of a sequence of <code>sosa:isSampleOf</code> relations (see <a href="#fig-observation-ultimate-foi">Figure 1</a>, <a href="#fig-sampling-ultimate-foi">Figure 2</a>).
    </p>
    <p>
      The rule can be expressed formally as a SPARQL query expression [[sparql11-query]] as follows:
    </p>
    <table class="definition" style="width: 100%;">
    <thead>
    <tr>
    <th style="width: 120px;">Property</th>
    <th>Rule</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td>
        <code><a href="#sosa:hasUltimateFeatureOfInterest">sosa:hasUltimateFeatureOfInterest</a></code>
      </td>
      <td>
        <pre class="nohighlight turtle">
          CONSTRUCT { ?this sosa:hasUltimateFeatureOfInterest ?f . }
          WHERE {
            { ?this a sosa:Observation } UNION { ?this a sosa:ObservationCollection } UNION { ?this a sosa:Sampling } UNION { ?this a sosa:Actuation }
            NOT EXISTS { ?this sosa:hasUltimateFeatureOfInterest ?x . } .
            ?this sosa:hasFeatureOfInterest/(sosa:isSampleOf)+ ?f .
            NOT EXISTS { ?f sosa:isSampleOf ?y . } .
          }
        </pre>
      </td>
    </tr>
    </table>
  </section>

  <section>
      <h4 id="uso-sampling-chain-rule">Finding the ultimate feature of interest that a Sample represents from a sampling chain</h4>
      <p>
        Sometimes it is useful to know what is the actual feature-of-interest that a sample represents. 
        If this is not asserted with a <a href="#sosa:hasSampledFeature">sosa:hasSampledFeature</a> then a candidate feature may be found by following a path from the sample to the end of a sequence of <code>sosa:isSampleOf</code> relations (see <a href="#fig-sampling-ultimate-foi">Figure 2</a>).
      </p>
      <p>
        This rule can be expressed formally as a SPARQL query expression [[?sparql11-query]] as follows:
      </p>
      <table class="definition" style="width: 100%;">
      <thead>
      <tr>
      <th style="width: 120px;">Property</th>
      <th>Rule</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>
          <code><a href="#sosa:hasSampledFeature">sosa:hasSampledFeature</a></code>
        </td>
        <td>
          <pre class="nohighlight turtle">
            CONSTRUCT { ?this sosa:hasSampledFeature ?f . }
            WHERE {
              ?this a sosa:Sample
              NOT EXISTS { ?this sosa:hasSampledFeature ?x . } .
              ?this (sosa:isSampleOf)+ ?f .
              NOT EXISTS { ?f sosa:isSampleOf ?y . } .
            }
          </pre>
        </td>
      </tr>
      </table>

      <p>Note that a sample might represent more than one feature of interest, different by scale or some other defining property. </p>
    </section>
  
    <section>
    <h4 id="os-sampling-chain-rule">Finding the original Sample from a sampling chain</h4>
    <p>
      Sometimes it is useful to know what was the original sample taken from the ultimate feature-of-interest that a sample represents. 
      If this is not asserted with a <a href="#sosa:hasOriginalSample">sosa:hasOriginalSample</a> then a candidate sample may be found by following a path from the sample through a sequence of <code>sosa:isSampleOf</code> relations until the last sample (see <a href="#fig-sampling-ultimate-foi">Figure 2</a>).
    </p>
    <p>
      This rule can be expressed formally as a SPARQL query expression [[?sparql11-query]] as follows:
    </p>
    <table class="definition" style="width: 100%;">
    <thead>
    <tr>
    <th style="width: 120px;">Property</th>
    <th>Rule</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td>
        <code><a href="#sosa:hasOriginalSample">sosa:hasOriginalSample</a></code>
      </td>
      <td>
        <pre class="nohighlight turtle">
          CONSTRUCT { ?this sosa:hasOriginalSample ?os . }
          WHERE {
            ?this a sosa:Sample
            NOT EXISTS { ?this sosa:hasOriginalSample ?x . } .
            ?this (sosa:isSampleOf)+ ?f .
            NOT EXISTS { ?f sosa:isSampleOf ?y . } .
            ?os sosa:isSampleOf ?f . 
            ?this (sosa:isSampleOf)+ ?os .
          }
        </pre>
      </td>
    </tr>
    </table>
    <p>Note that most important original sample might not be the one closest to the domain feature. 
      For example, in <a href="#fig-sample-chain-geology"></a> for many practical scenarios it will be a sample retrieved from the field that is of interest, and not the outcrop which is also modeled as a sample of the geologic unit. 
      In such a case an explicit assertion of the original sample will be more relevant than the computed one. </p>
  </section>

  <section>
    <h4 id="container-property-rule">Inheriting observation properties from a collection</h4>
    <p>
      If a <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAObservation">sosa:Observation</a></code> or <code><a href="#sosa:ObservationCollection">sosa:ObservationCollection</a></code> is a member of an <code><a href="#sosa:ObservationCollection">sosa:ObservationCollection</a></code>,
      the properties of the collection as a whole are associated with all member observations or collections.
    </p>
    <p class="note">
      Assigning properties to a collection provides for efficiencies in both discovery and encoding.
    </p>
    <p>
      The rules may be defined formally as SPARQL query expressions [[?sparql11-query]] as follows:
    </p>
    <table class="definition" style="width: 100%;">
    <thead>
    <tr>
    <th style="width: 120px;">Property</th>
    <th>Rule</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td>
        <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAhasFeatureOfInterest">sosa:hasFeatureOfInterest</a></code>
        <code><a href="#has-ultimate-feature-of-interest">sosa:hasUltimateFeatureOfInterest</a></code>
        <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAmadeBySensor">sosa:madeBySensor</a></code>
        <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAobservedProperty">sosa:observedProperty</a></code>
        <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAphenomenonTime">sosa:phenomenonTime</a></code>
        <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAresultTime">sosa:resultTime</a></code>
        <code><a href="https://www.w3.org/TR/vocab-ssn/#SOSAusedProcedure">sosa:usedProcedure</a></code>
      </td>
      <td>
        <pre>
CONSTRUCT { ?this $property ?foi . }
WHERE {
  ?this a sosa:Observation .
  NOT EXISTS { ?this $property ?x . } .
  ?oc sosa:hasMember+ ?this .
  ?oc $property ?foi .
}</pre><br/>
In the above expression, <code>$property</code> is replaced by any one of the seven properties listed
      </td>
    </tr>
    </tbody>
    </table>

  </section>

</section>
</section>

<section>
  <h2>Alignments</h2>
  <section>
    <h3>RDF Data Cube vocabulary</h3>
    <p>
      The W3C RDF Data Cube vocabulary [[?vocab-data-cube]] provides a means to describe multi-dimensional data according to a 'data cube' model inspired by SDMX, from which a 'slice' represents a collection of observations that is homogeneous in some property or dimension.
      Hence, for a collection of observations the datacube (<code>qb:</code>) model may be used to express aspects of homogeneity - such as whether a set of observations are all related to the same ultimate feature of interest, or the same <i>type</i> of feature of interest etc. Feature of interest, phenomenon time, observation procedure will typically correspond to <code>qb:dimension</code> sub-properties, <code>qb:measures</code> will be the observed properties and <code>qb:ComponentDescriptions</code> for <code>qb:measures</code> may indicate result types. <code>qb:attribute</code> sub-properties may be used for qualifying and annotating information.
    </p>
    <p>
In future a general model for the inter-relation of dimensions, sensors, observed properties, phenomena, units of measure, sampling precision, procedures, etc. could use qb:dimension concepts to describe observation and sampling strategies.
</p>
    <p class="note">
      If the value of any of the properties such as the <code>sosa:hasFeatureOfInterest</code>, <code>sosa:hasUltimateFeatureOfInterest</code>, or <code>sosa:phenomenonTime</code> is locally specified, and is different to the value on the containing sosa:ObservationCollection, the results of the collection do not correspond with a slice from a data cube.
    </p>
  </section>
  <section>
    <h3>OBOE</h3>
    <p>The <a href="https://www.w3.org/TR/vocab-ssn/#OBOE_Alignment">OBOE alignment module in SSN</a> [[vocab-ssn]] provided an alignment for the atomic <code>oboe:Measurement</code> to <a href="https://www.w3.org/TR/vocab-ssn/#SOSAObservation">sosa:Observation</a>, but not for <code>oboe:Observation</code>.
      The <code>ObservationCollection</code> supports the full encoding of an <code>oboe:Observation</code>, which is a collection of <code>oboe:Measurements</code> concerning a common <code>oboe:Entity</code>, with each <code>oboe:Measurement</code> reporting the value of a different <code>oboe:Characteristic</code>, as shown in <a href="#oboe-implementation"></a>.
    </p>
    
    <figure id="oboe-implementation">
      <img alt="The OBOE core model" src="./images/OBOE-core.png"/ style="width:40%"><img alt="The SSN-ext model arranged to align with OBOE" src="./images/SOSA-ssn-ext.png" style="width:50%"/>
      <figcaption>
        The OBOE core model (left), shown alongside the SSN-ext model (right) with comparable classes and properties aligned - new properties and classes shown in red.
      </figcaption></figcaption>
    </figure>
    
  </section>
  <!--
  <section>
    <h3>W3C PROV-O vocabulary</h3>
    <p>
      TBD
    </p>
  </section>
-->

</section>

<hr />
<section class="appendix" id="ack">
<h2>Acknowledgements</h2>
<p>This work was partly supported by <a href="https://tern.org.au/">TERN</a>. </p>
<p>The editor would like to thank the <a href="https://www.w3.org/2000/09/dbwg/details?group=75471&public=1">members of the W3C/OGC Spatial Data on the Web Interest Group</a> for their contributions during the development of this document. </p>
</section>

</body>
</html>
